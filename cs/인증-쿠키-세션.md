# 인증 (Authentication)

회원인가? 판단한다.  
http는 상태가 없기에 어딘가에서 회원인지 알려주지 않는다면, 로그인 페이지를 벗어나 다른페이지로 가면 로그인이 풀려버릴것이다.  
따라서 회원인지 알려주는 정보를 서버로 보내 회원인지 확인 한 후 어떻게든 저장을 해야 한다.

<br>

## 쿠키

### 정의

1. 서버가 사용자의 웹 브라우저에 전송하는 작은 데이터 조각 (약 4KB)
2. 브라우저에 키-벨류 형식으로 저장
3. 동일한 서버에 재 요청 시 저장된 데이터를 같이 전송

<br>

### 용도

세션관리, 사용자 행동 기록, 테마 세팅 등에 사용된다.  
http의 상태가 없는 속성으로 인해, 상태 정보를 기억하기 위해 쓴다.

<br>

### 라이프타임

1. 세션쿠키는, 세션이 끝날때 까지 생존
2. expires 속성, max-age 속성에 따라 명시된 기간에 생존

<br>

### secure쿠키, HttpOnly쿠키

secure쿠키는 https의 암호화된 요청에서만 전송된다. 하지만 본질적으로 안전하진 않다.

<br>

HttpOnly쿠키는 XSS공격 방지를 위해 전역변수로 접근이 금지된다. (document.cookie로 접근이 안된다는 뜻)  
단지 서버에 전송되기만한다.

<br>

### 알아두기

과거 클라이언트에 정보를 저장해야할때 쿠키에 주로 저장했지만 쿠키는 모든 요청마다 함께 전송되기에 (요청의 헤더에 있다) 성능상 좋지 않을 수 있다. 따라서 클라이언트에 정보를 저장해야 한다면 로컬스토리지, 세션스토리지를 활용하는게 좋다.

<br>

## 세션

1. 브라우저가 종료되기 전 까지 (기간. 세션) 상태를 저장
2. 쿠키는 클라이언트에 저장되어 있었지만, 세션은 웹 서버에 저장된다.
3. 인증이 성공했다는 의미로 sessionId를 암호화해 쿠키의 형태로 클라이언트에 전달
4. 세션은 웹 서버에 저장되기에 메모리를 차지한다. 만약 사용자가 급격히 증가한다면 서버의 성능에 영향을 미칠수도 있다.

<br>

따라서 쿠키와 세션을 이용해 인증을 할 수 있다.  
로그인 -> DB에서 유저 검증 -> 세션 생성 및 id 발급 -> 쿠키에 저장 -> 인증
